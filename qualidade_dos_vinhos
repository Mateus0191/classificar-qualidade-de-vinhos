import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import classification_report

# 1. Buscando os dados direto da fonte (UCI Repository)
# Escolhi o dataset de vinho tinto por ser um clássico para testes de classificação
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv"
dados = pd.read_csv(url, sep=';')

# 2. Criando a nossa meta (Target)
# Como prever a nota exata é difícil, simplifiquei o problema:
# Vinhos com nota 6 ou mais viram '1' (Bom) e o resto vira '0' (Ruim)
dados['qualidade_binaria'] = [1 if x >= 6 else 0 for x in dados['quality']]

# 3. Organizando as variáveis
# 'qual' contém as características químicas. Removi as colunas de nota original
# para a IA não saber a resposta antes de tentar prever.
qual = dados.drop(['quality', 'qualidade_binaria'], axis=1)
b = dados['qualidade_binaria']

# 4. Dividindo o conjunto de dados
# Usei 80% para a rede aprender e deixei 20% guardados para o teste final
X_train, X_test, y_train, y_test = train_test_split(qual, b, test_size=0.2, random_state=42)

# 5. Ajuste de escala (StandardScaler)
# Isso é importante porque variáveis como 'pH' e 'açúcar' têm valores muito diferentes.
# O scaler coloca tudo na mesma importância para a rede neural.
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

# 6. Configurando a Rede Neural (Multilayer Perceptron)
# Usei duas camadas de 10 neurônios. É uma arquitetura simples para 
# evitar que o modelo apenas "decore" os dados (overfitting).
mlp = MLPClassifier(hidden_layer_sizes=(10, 10), max_iter=500, random_state=42)

# Treinando o modelo com os dados de treino
mlp.fit(X_train, y_train)

# 7. Testando o que a IA aprendeu
previsoes = mlp.predict(X_test)

# Agora ira mostrar o resultado final
print("Relatório de Classificação:")
print(classification_report(y_test, previsoes))